{% load pages html compress ratings site %}

<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
        <meta name="description" content="{% block meta_description %}{% meta_description %}{% endblock %}">
        <meta name="robots" content="{% block meta_robots %}{% meta_robots %}{% endblock %}">
        <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
        <link rel="canonical" href="{% canonical_url %}"/>

        <!-- Open Graph data -->
        <meta property="og:title" content="{% block og_title %}{% og_title %}{% endblock %}">
        <meta property="og:url" content="{% canonical_url %}">
        <meta property="og:type" content="website">
        <meta property="og:description" content="{% block og_description %}{% og_description %}{% endblock %}">
        <meta property="og:image" content="{% block og_image %}{% og_image %}{% endblock %}">

        <title>{% block title %}{% title %}{% endblock %}</title>

        {% block feeds %}{% endblock %}

        <link href='http://fonts.googleapis.com/css?family=Lato:400,700|Open+Sans:400,600' rel='stylesheet' type='text/css'>

        {% compress css %}
            <link rel="stylesheet" href="/static/build/css/normalize.css"/>
            <link rel="stylesheet" href="/static/build/css/screen.css"/>
            <link rel="stylesheet" href="/static/build/css/dropzone.css"/>

            <style>
            span[title] {
                cursor: help;
            }
            </style>
        {% endcompress %}

        <script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>

        <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
        <link rel="apple-touch-icon" sizes="57x57" href="/static/build/img/icons/apple-touch-icon-57x57.png">
        <link rel="apple-touch-icon" sizes="60x60" href="/static/build/img/icons/apple-touch-icon-60x60.png">
        <link rel="apple-touch-icon" sizes="72x72" href="/static/build/img/icons/apple-touch-icon-72x72.png">
        <link rel="apple-touch-icon" sizes="76x76" href="/static/build/img/icons/apple-touch-icon-76x76.png">
        <link rel="apple-touch-icon" sizes="114x114" href="/static/build/img/icons/apple-touch-icon-114x114.png">
        <link rel="apple-touch-icon" sizes="120x120" href="/static/build/img/icons/apple-touch-icon-120x120.png">
        <link rel="apple-touch-icon" sizes="144x144" href="/static/build/img/icons/apple-touch-icon-144x144.png">
        <link rel="apple-touch-icon" sizes="152x152" href="/static/build/img/icons/apple-touch-icon-152x152.png">
        <link rel="apple-touch-icon" sizes="180x180" href="/static/build/img/icons/apple-touch-icon-180x180.png">
        <link rel="icon" type="image/png" href="/static/build/img/icons/favicon-16x16.png" sizes="16x16">
        <link rel="icon" type="image/png" href="/static/build/img/icons/favicon-32x32.png" sizes="32x32">
        <link rel="icon" type="image/png" href="/static/build/img/icons/favicon-96x96.png" sizes="96x96">
        <link rel="icon" type="image/png" href="/static/build/img/icons/android-chrome-192x192.png" sizes="192x192">
        <meta name="msapplication-square70x70logo" content="/static/build/img/icons/smalltile.png" />
        <meta name="msapplication-square150x150logo" content="/static/build/img/icons/mediumtile.png" />
        <meta name="msapplication-wide310x150logo" content="/static/build/img/icons/widetile.png" />
        <meta name="msapplication-square310x310logo" content="/static/build/img/icons/largetile.png" />
    </head>

    <body class="{% block body_class %}{% endblock %}">

        {% if settings.GOOGLE_ANALYTICS %}
        <script>
          (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
          (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
          })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

          ga('create', '{{ settings.GOOGLE_ANALYTICS }}', 'auto');
          ga('send', 'pageview');

        </script>
        {% endif %}

        {% include 'browser_update.html' %}

        <div class="row page-wrapper">
            <header>
                <div class="row">
                    <div class="small-6 medium-3 columns logo-container left">
                        <a href="/" class="secondary">
                            <img src="/static/build/img/social_logo.png">
                            <span class="logo-text">Rocket League<br>Replays</span>
                        </a>
                    </div>

                    <ul class="small-6 medium-9 columns text-right primary-navigation">
                        {% get_navigation pages.homepage.navigation as nav %}

                        {% for item in nav %}
                            {% if item.url == '/replays/' and request.path == '/replays/upload/' %}
                                <li><a href="{{ item.url }}">{{ item.title }}</a></li>
                            {% else %}
                                <li><a href="{{ item.url }}"{% if item.here or item.url == '/upload-replay/' and request.path == '/replays/upload/' %} class="active"{% endif %}>{{ item.title }}</a></li>
                            {% endif %}
                        {% endfor %}

                        <li>&middot;</li>

                        <li><a href="http://www.reddit.com/r/RocketLeagueReplays/" target="_blank" title="Reddit" class="socicon">C</a></li>
                        <li><a href="http://www.twitter.com/RLReplays" target="_blank" title="Twitter" class="socicon">a</a></li>

                    </ul>
                </div>

                <div class="row secondary-navigation">
                    <div class="medium-6 columns ">
                        {% if 'steam' not in backends.not_associated %}
                            {% league_data as data %}
                            {% if data %}
                                {% if data.10 %}
                                <span title="This is your rating for ranked duels.">
                                    Duels: {{ data.10 }}

                                    {% if 10 in user.profile.rating_diff and user.profile.rating_diff.10 != 0 %}
                                        {% if user.profile.rating_diff.10 < 0 %}
                                            <span class="rating-down">
                                                <em class="icon-down-dir"></em>
                                                {{ user.profile.rating_diff.10|wrap:"abs" }}
                                        {% else %}
                                            <span class="rating-up">
                                                <em class="icon-up-dir"></em>
                                                {{ user.profile.rating_diff.10 }}
                                        {% endif %}


                                        </span>
                                    {% endif %}
                                </span> /
                                {% endif %}

                                {% if data.11 %}
                                <span title="This is your rating for ranked doubles.">
                                    Doubles: {{ data.11 }}

                                    {% if 11 in user.profile.rating_diff and user.profile.rating_diff.11 != 0 %}
                                        {% if user.profile.rating_diff.11 < 0 %}
                                            <span class="rating-down">
                                                <em class="icon-down-dir"></em>
                                                {{ user.profile.rating_diff.11|wrap:"abs" }}
                                        {% else %}
                                            <span class="rating-up">
                                                <em class="icon-up-dir"></em>
                                                {{ user.profile.rating_diff.11 }}
                                        {% endif %}


                                        </span>
                                    {% endif %}
                                </span> /
                                {% endif %}

                                {% if data.12 %}
                                <span title="This is your rating for ranked solo standard.">
                                    Solo Standard: {{ data.12 }}

                                    {% if 12 in user.profile.rating_diff and user.profile.rating_diff.12 != 0 %}
                                        {% if user.profile.rating_diff.12 < 0 %}
                                            <span class="rating-down">
                                                <em class="icon-down-dir"></em>
                                                {{ user.profile.rating_diff.12|wrap:"abs" }}
                                        {% else %}
                                            <span class="rating-up">
                                                <em class="icon-up-dir"></em>
                                                {{ user.profile.rating_diff.12 }}
                                        {% endif %}


                                        </span>
                                    {% endif %}
                                </span> /
                                {% endif %}

                                {% if data.13 %}
                                <span title="This is your rating for ranked standard.">
                                    Standard: {{ data.13 }}

                                    {% if 13 in user.profile.rating_diff and user.profile.rating_diff.13 != 0 %}
                                        {% if user.profile.rating_diff.13 < 0 %}
                                            <span class="rating-down">
                                                <em class="icon-down-dir"></em>
                                                {{ user.profile.rating_diff.13|wrap:"abs" }}
                                        {% else %}
                                            <span class="rating-up">
                                                <em class="icon-up-dir"></em>
                                                {{ user.profile.rating_diff.13 }}
                                        {% endif %}


                                        </span>
                                    {% endif %}
                                </span>
                                {% endif %}
                            {% endif %}
                        {% endif %}
                    </div>
                    <div class="medium-6 columns right text-right ">
                        {% if user.is_authenticated %}

                        {% if 'steam' in backends.not_associated %}
                            <a href="{% url 'social:begin' backend='steam' %}">Connect to Steam</a>
                        {% endif %}

                        <a href="{% url 'users:profile' %}">Account</a>

                        <a href="{% url 'auth:auth_logout' %}">Logout</a>
                        {% else %}
                        <a href="{% url 'register' %}">Register</a>

                        <a href="{% url 'auth:auth_login' %}">Log in</a>
                        {% endif %}
                    </div>
                </div>
            </header>

            <div class="alert-box info"><strong>Want to upload your replays automatically?</strong> Try our new <a href="{% url 'users:desktop_application' %}">desktop application</a>!</div>

            <main>
                {% block content_primary %}{{pages.current.content.content_primary|html}}{% endblock %}
            </main>

            {% block footer %}
            {# {% upload_form %} #}

            <footer class="row">
                <div class="medium-12 columns text-center hide-below-banner-width">
                    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
                    <!-- Detail page -->
                    <ins class="adsbygoogle"
                         style="display:inline-block;width:728px;height:90px"
                         data-ad-client="ca-pub-1408820986188374"
                         data-ad-slot="3142548889"></ins>
                    <script>
                    (adsbygoogle = window.adsbygoogle || []).push({});
                    </script>
                </div>

                <div class="small-12 columns">
                    <p>Rocket League Replays was created by <a href="http://danielsamuels.co.uk/" target="_blank">Daniel Samuels</a>. Source code available on <a href="https://github.com/danielsamuels/rocket-league-replays">Github</a>.</p>
                    <p>All product and company names are trademarks&trade; or registered&reg; trademarks of their respective holders.<br>Use of them does not imply any affiliation with or endorsement by them.</p>
                </div>
            </footer>
            {% endblock %}
        </div>

        <div class="dropzone-previews"></div>

        {% compress js %}
        <script src="/static/js/vendor/dropzone.js"></script>
        <script src="/static/js/vendor/jquery.cookie.js"></script>

        <script src="/static/js/vendor/fastclick.js"></script>

        <script src="/static/js/vendor/foundation/foundation.js"></script>
        <script src="/static/js/vendor/foundation/foundation.tab.js"></script>

        <script src="/static/js/vendor/jquery.canvasjs.min.js"></script>
        <script src="/static/build/js/shared.js"></script>
        <script src="/static/build/js/app.js"></script>

        <script>
            $(document).foundation();

            upload_dropzone = new Dropzone(
                document.body, {
                    url: "{% url 'replay:upload' %}",
                    headers: {
                        'X-CSRFToken': $.cookie('csrftoken')
                    },
                    createImageThumbnails: false,
                    clickable: false,
                    previewsContainer: '.dropzone-previews',
                    error: function(file, response) {
                            $('.dz-error-message', file.previewElement).html(response);
                    },
                    success: function(file, response, xhr) {
                            $('.dz-error-message', file.previewElement).html("Your replay has been successfully uploaded, you can view it <a href=\"" + response + "\" target=\"_blank\">here</a>.");
                    },
                    drop: function() {
                        $('body').addClass('dz-have-files')
                        $('main').on('click', function() {
                            $('body').removeClass('dz-have-files');
                            upload_dropzone.removeAllFiles();
                        });
                    }
                }
            );
        </script>

        {% block additional_js %}{% endblock %}
        {% endcompress %}

        <script>
        {% if user.is_authenticated %}
            $('[data-user="{{ user.pk }}"]').addClass('is-current-user');
        {% endif %}
        </script>
    </body>
</html>
