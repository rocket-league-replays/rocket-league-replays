{% with ratings=user.profile.latest_ratings %}
<div class="row text-center">
    <div class="medium-4 columns">
        Solo

        <h4>{{ ratings.10 }}</h4>
    </div>

    <div class="medium-4 columns">
        Doubles

        <h4>{{ ratings.11 }}</h4>
    </div>

    <div class="medium-4 columns">
        Standard

        <h4>{{ ratings.12 }}</h4>
    </div>
</div>
{% endwith %}

<div id="chartContainer" style="height: 600px; width: 100%;"></div>

<script src="/static/js/vendor/jquery.canvasjs.min.js"></script>


{# |slice:":10" #}
{% with ratings=user.leaguerating_set.all %}
<script>
  $('.tabs').on('toggled', function (event, tab) {
    if ($('a', tab[0]).html() == "Rank tracker") {
        var chart = new CanvasJS.Chart("chartContainer",
        {
            zoomEnabled: true,
            title:{
                text: "Historical ratings per playlist",
                fontSize: 14,
            },
            axisX: {
                title: "Date / Time",
                labelFontSize: 14,
                titleFontSize: 14,
                labelFormatter: function(e) {
                    return CanvasJS.formatDate(e.value, "DD/MM/YYYY");
                },
                valueFormatString: "DD/MM/YYYY HH:MM"
            },
            axisY: {
                title: "Rating",
                labelFontSize: 14,
                titleFontSize: 14,
            },
            legend: {},
            data: [
                {
                    name: "Duels",
                    type: "line",
                    xValueType: "dateTime",
                    dataPoints: [
                        {% for rating in ratings reversed %}
                            { x: Date.parse("{{ rating.timestamp|date:'r' }}"), y: {{ rating.duels }}},
                        {% endfor %}
                    ]
                },
                {
                    name: "Doubles",
                    type: "line",
                    xValueType: "dateTime",
                    dataPoints: [
                        {% for rating in ratings reversed %}
                            { x: Date.parse("{{ rating.timestamp|date:'r' }}"), y: {{ rating.doubles }}},
                        {% endfor %}
                    ]
                },
                {
                    name: "Standard",
                    type: "line",
                    xValueType: "dateTime",
                    dataPoints: [
                        {% for rating in ratings reversed %}
                            { x: Date.parse("{{ rating.timestamp|date:'r' }}"), y: {{ rating.standard }}},
                        {% endfor %}
                    ]
                }
            ],
            toolTip: {
                shared: true,
            }
        });

        chart.render();
    }
});
</script>
{% endwith %}

<style>
#chartContainer {
    margin-top: 30px;
}
</style>
